---
title: 常见问题
date: 2021-08-30 20:25:51
permalink: /pages/086431/
categories:
  - 百科
  - 技术文档
tags:
  - 
---
## 1./usr/bin/dpkg returned an error code (1)
### 解决dpkg错误
```bash
cd /var/lib/dpkg
sudo mv info info.baksudo
mkdir info
```

## 2.添加用户名和添加sudo
### 添加用户名
```bash
sudo useradd -m -d /data/username -s /bin/zsh username
```
### 修改密码
```bash
sudo passwd username
```
### 添加sudoers
```bash
vi /etc/sudoers
#添加用户
username    ALL=(ALL:ALL) ALL
```
## 3.Ubuntu安装Linux开发包
```bash
sudo apt-get install build-essential
```

## 4.Python 相关错误
### 4.1 Python ImportError: No module named _bz2
```bash
sudo apt-get install libbz2-dev
#重新编译Python
```
### 4.1 ImportError: Missing optional dependency 'openpyxl'
```bash
pip install openpyxl
#重新编译Python
```

## 5.安装Mongodb
#### （1）导入公匙
```bash
wget -qO - https://www.mongodb.org/static/pgp/server-5.0.asc | sudo apt-key add -
```
#### （2）创建mongodb列表文件
```bash
echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/5.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-5.0.list
```
#### （3）重新加载包数据
```bash
sudo apt-get update
```
#### （4）重新加载包数据
```bash
sudo apt-get install -y mongodb-org=5.0.2 mongodb-org-database=5.0.2 mongodb-org-server=5.0.2 mongodb-org-shell=5.0.2 mongodb-org-mongos=5.0.2 mongodb-org-tools=5.0.2
```
#### （5）服务启动
```bash
sudo systemctl start mongod
```

## 6.修改Mongodb配置，添加用户
#### （1）修改配置
```bash
sudo vim /etc/mongod.conf
```
#### （2）连接Mongodb
```bash
echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/5.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-5.0.list
```
#### （3）重新加载包数据
```bash
use Production
db.createUser(
   {
     user: "production",
     pwd: "production@123",  // passwordPrompt() Or  "<cleartext password>"
     roles: [ "readWrite", "dbAdmin" ]
   }
)
```
#### （4）登录
```bash
db.auth("production")
```

## 7.apt重新配置
#### （1）修复Python
当前的系统python如果有错误了，也需要一起修复，这个版本的python不能随便的更改，需要从一个正常的linux系统下把python复制出来。
```bash
# 版本正常的python3.6
mkdir python3.6
cd python3.6
mkdir python3.6-lib
mkdir python3-lib
mkdir x86_64-linux-gnu
cp -rf /usr/bin/python3.6* ~/python3.6
cp -rf /usr/lib/python3.6/* ~/python3.6/python3.6-lib
cp -rf /usr/lib/python3/* ~/python3.6/python3-lib
cp -rf /usr/lib/x86_64-linux-gnu/*apt* ~/x86_64-linux-gnu/
cd ..
tar zcvf python3.6.tar.gz python3.6
scp python3.6.tar.gz user@localhost:~
# 待修复的linux主机
tar zxvf python3.6.tar.gz
cd python3.6
sudo cp -rf python3.6 /usr/bin
sudo cp -rf python3.6m /usr/bin
sudo cp -rf python3.6-lib/* /usr/lib/python3.6
sudo cp -rf python3-lib/* /usr/lib/python3
```
#### （2）修复动态库
```bash
dpkg -l apt
```![微信截图_20210915181441](https://cdn.jsdelivr.net/gh/SivanLaai/image-store-rep@master/wiki/微信截图_20210915181441.jaogs5xn7dk.png)

其中版本是```2.0.2ubuntu0.2```，下载对应的安装包并安装：

```bash
# 安装apt
wget http://mirrors.edge.kernel.org/ubuntu/pool/main/a/apt/apt_2.0.2ubuntu0.2_amd64.deb
sudo dpkg -i apt_2.0.2ubuntu0.2_amd64.deb
# 有时候提示缺少libapt-pkg6.0.so
# 安装apt-pkg依赖
wget http://mirrors.edge.kernel.org/ubuntu/pool/main/a/apt/libapt-pkg6.0_2.0.2ubuntu0.2_amd64.deb
sudo dpkg -i libapt-pkg6.0_2.0.2ubuntu0.2_amd64.deb
```

#### （3）测试apt
```bash
sudo apt update
```
